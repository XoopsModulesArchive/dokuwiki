function indexmenu_toolbar_additions(){var edbtn,cmenu,indx_btn,toolbar=$("tool__bar");if(!toolbar){return;}edbtn=$("edbtn__save");if(!edbtn){return;}indexmenu_createPicker("picker_plugin_indexmenu");indx_btn=indexmenu_createToolbar();eval("indx_btn.onclick = function(){indexmenu_ajax('req=local','picker_plugin_indexmenu',this,true);return false;}");toolbar.appendChild(indx_btn);cmenu=window.indexmenu_contextmenu;if(cmenu[1]){window.indexmenu_contextmenu[0]=cmenu[1].concat(cmenu[0]);}}function indexmenu_createThemes(b,a){var checkboxes=new Array(new Array("navbar","The tree opens at the current namespace. Good for navigation sidebars."),new Array("id#random","To be used in case of two or more navbar indexmenu trees."),new Array("<br>",0),new Array("tsort","Sort by title."),new Array("dsort","Sort by date."),new Array("msort","Sort by meta tag."),new Array("nsort","Sort namespaces."),new Array("<br>",0),new Array("max#2","How many levels to render with ajax when a node is opened."),new Array("maxjs#2","How many levels to render in the client browser when a node is opened."),new Array("<br>",0),new Array("nocookie","No cookies."),new Array("nons","Show only pages."),new Array("noscroll","Prevent to scrolling the tree when it does not fit the container width."),new Array("notoc","Disable the toc preview feature."));var btn,ico,title,key,url,adata,check,f,l,f2,fo2,l2,la,f3,l3;adata=b.split(",");check=adata.shift();if(check!="indexmenu"){a.innerHTML="No themes";adata=[];}else{url=adata.shift();url+=adata.shift();}f=document.createElement("fieldset");l=document.createElement("legend");l.innerHTML="Themes";f.appendChild(l);for(key in adata){btn=document.createElement("button");btn.className="pickerbutton";ico=document.createElement("img");ico.src=url+"/"+adata[key]+"/base."+indexmenu_findExt(adata[key]);title=adata[key];btn.title=title;btn.appendChild(ico);if(title=="default"){title="";}else{title="#"+title;}eval("btn.onclick = function(){indexmenu_opts('"+title+"');}");if(title===""){f.insertBefore(btn,a.firstChild);}else{f.appendChild(btn);}}a.appendChild(f);f2=f.cloneNode(false);fo2=document.createElement("form");fo2.id="indexmenu_optfrm";fo2.className="indexmenu_opts";l2=l.cloneNode(false);l2.innerHTML="Options";f2.appendChild(l2);for(key in checkboxes){la=document.createElement("label");la.innerHTML=checkboxes[key][0]+" ";if(checkboxes[key][1]){la.title=checkboxes[key][1];btn=document.createElement("input");btn.type="checkbox";btn.name="check";btn.title=checkboxes[key][1];btn.value=checkboxes[key][0];fo2.appendChild(btn);}fo2.appendChild(la);}f2.appendChild(fo2);a.appendChild(f2);f3=f.cloneNode(false);l3=l.cloneNode(false);l3.innerHTML="Extra";f3.appendChild(l3);btn=document.createElement("button");btn.className="pickerbutton";ico=document.createElement("img");ico.src=url+"/msort.gif";btn.title="Insert meta sort number";btn.appendChild(ico);eval("btn.onclick = function(){insertTags('"+jsEscape("wiki__text")+"','"+jsEscape("{{indexmenu_n>")+"','"+jsEscape("}}")+"','"+jsEscape("1")+"');$('picker_plugin_indexmenu').style.display='none';return false;}");f3.appendChild(btn);a.appendChild(f3);}function indexmenu_createToolbar(){var indx_ico=document.createElement("img");indx_ico.src=DOKU_BASE+"lib/plugins/indexmenu/images/indexmenu_toolbar.png";var indx_btn=document.createElement("button");indx_btn.id="syntax_plugin_indexmenu";indx_btn.className="toolbutton";indx_btn.title="Insert the Indexmenu tree";indx_btn.appendChild(indx_ico);return indx_btn;}function indexmenu_createPicker(a){var indx_list=document.createElement("div");indx_list.className="picker";indx_list.id=a;indx_list.style.position="absolute";indx_list.style.display="none";var body=document.getElementsByTagName("body")[0];body.appendChild(indx_list);return indx_list;}function indexmenu_opts(a){var i,v="";var f=$("indexmenu_optfrm");for(i=0;i<f.length;i++){if(f[i].checked){v=v+" "+f[i].value;}}insertTags(jsEscape("wiki__text"),jsEscape("{{indexmenu>"),jsEscape("|js"+a+v+"}}"),jsEscape(".#1"));$("picker_plugin_indexmenu").style.display="none";return false;}function indexmenu_insertTags(b,a){var r,l=b;if(a){r=new RegExp(a,"g");l=b.replace(r,":");}insertTags(jsEscape("wiki__text"),jsEscape("[["),jsEscape("]]"),jsEscape(l));}indexmenu_toolbar_additions();
